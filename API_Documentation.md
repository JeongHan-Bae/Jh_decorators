# API Documentation / 接口文档

This document provides an overview of the available decorators and utilities in the `jh_decorators` package. / 本文档提供了 `jh_decorators` 包中可用的装饰器和实用程序的概述。

## Table of Contents / 目录

1. [Inner Decorator / 内部装饰器](#inner-decorator--内部装饰器)
2. [Override Decorator / 重载装饰器](#override-decorator--重载装饰器)
3. [Jsonize Decorator / Json化装饰器](#jsonize-decorator--json化装饰器)
4. [Dictize Decorator / 字典化装饰器](#dictize-decorator--字典化装饰器)
5. [XMLize Decorator / XML化装饰器](#xmlize-decorator--xml化装饰器)
6. [YAMLize Decorator / YAML化装饰器](#yamlize-decorator--yaml化装饰器)
7. [Timing Decorator / 计时装饰器](#timing-decorator--计时装饰器)
8. [Log Decorator / 日志装饰器](#log-decorator--日志装饰器)
9. [ProgressBar Decorator / 进度条装饰器](#progressbar-decorator--进度条装饰器)
10. [Annotation Decorator / 注解装饰器](#annotation-decorator--注解装饰器)
11. [generate_api Function / 生成API函数](#generate_api-function--生成api函数)
12. [Global Variable Management / 全局变量管理](#global-variable-management--全局变量管理)

---

## Inner Decorator / 内部装饰器

Marks a function or class as internal, making it inaccessible outside its defining module. / 将函数或类标记为内部，使其在定义模块之外不可访问。

### Usage / 用法

```python
from jh_decorators.interface import Inner

@Inner
def internal_function():
    pass

@Inner
class InternalClass:
    def __init__(self):
        self.value = 42

    def method(self):
        return self.value
```

### Arguments / 参数

- `item (Callable)`: The callable to be marked as internal. / 要标记为内部的可调用对象。

### Notes / 注意事项

1. Functions and classes marked as internal cannot be accessed from outside the module where they are defined. / 被标记为内部的函数和类无法在定义模块之外访问。
2. Classes marked as internal cannot be instantiated, nor can their methods be called from outside the defining module. However, static attributes of such classes remain accessible. / 被标记为内部的类无法实例化，也不能从定义模块外部调用其方法。但是，这些类的静态属性仍然可以访问。
3. Any content wrapped by `Inner` will not be included in the `.pyi` file generated by `generate_api`, ensuring they remain hidden. / 任何被 `Inner` 包装的内容都不会包含在 `generate_api` 生成的 `.pyi` 文件中，确保它们保持隐藏。

### Example / 示例

```python
@Inner
class Example:
    attribute = 42

# This will raise an error
example = Example()

# This will raise an error
Example().method()

# This will work
print(Example.attribute)  # Output: 42
```

---

## Override Decorator / 重载装饰器

Ensures that a method overrides a method in its superclass, raising an error if it does not. / 确保方法重载其超类中的方法，如果没有，则引发错误。

### Usage / 用法

```python
from jh_decorators.interface import Override

class Base:
    def method(self):
        pass

class Derived(Base):
    @Override
    def method(self):
        pass
```

### Arguments / 参数

- `method (Callable)`: The method to be checked for overriding. / 要检查重载的方法。

### Example / 示例

```python
class Parent:
    def greet(self):
        print("Hello from Parent")

class Child(Parent):
    @Override
    def greet(self):
        print("Hello from Child")

# This will work
child = Child()
child.greet()  # Output: Hello from Child

class AnotherChild(Parent):
    @Override
    def say_hello(self):
        print("Hello from AnotherChild")

# This will raise an OverrideError since 'say_hello' is not defined in Parent
another_child = AnotherChild()
```

---

## Jsonize Decorator / Json化装饰器

Adds methods to convert an instance to/from a JSON string. / 添加方法以将实例转换为/从JSON字符串转换。

### Usage / 用法

```python
from jh_decorators.reflection import Jsonize

@Jsonize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b
```

### Methods / 方法

- `to_json(self)`: Convert instance to JSON string. / 将实例转换为JSON字符串。
- `from_json(cls, json_str)`: Create an instance from a JSON string. / 从JSON字符串创建实例。

### Example / 示例

```python
@Jsonize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b

instance = MyClass(1, 2)
json_str = instance.to_json()
print(json_str)  # Output: {"a": 1, "b": 2}

new_instance = MyClass.from_json(json_str)
print(new_instance.a, new_instance.b)  # Output: 1 2
```

---

## Dictize Decorator / 字典化装饰器

Adds methods to convert an instance to/from a dictionary. / 添加方法以将实例转换为/从字典转换。

### Usage / 用法

```python
from jh_decorators.reflection import Dictize

@Dictize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b
```

### Methods / 方法

- `to_dict(self)`: Convert instance to dictionary. / 将实例转换为字典。
- `from_dict(cls, data)`: Create an instance from a dictionary. / 从字典创建实例。

### Example / 示例

```python
@Dictize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b

instance = MyClass(1, 2)
dict_repr = instance.to_dict()
print(dict_repr)  # Output: {'a': 1, 'b': 2}

new_instance = MyClass.from_dict(dict_repr)
print(new_instance.a, new_instance.b)  # Output: 1 2
```

---

## XMLize Decorator / XML化装饰器

Adds methods to convert an instance to/from an XML string. / 添加方法以将实例转换为/从XML字符串转换。

### Usage / 用法

```python
from jh_decorators.reflection import XMLize

@XMLize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b
```

### Methods / 方法

- `to_xml(self)`: Convert instance to XML string. / 将实例转换为XML字符串。
- `from_xml(cls, xml_str)`: Create an instance from an XML string. / 从XML字符串创建实例。

### Example / 示例

```python
@XMLize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b

instance = MyClass(1, 2)
xml_str = instance.to_xml()
print(xml_str)
# Output:
# <MyClass>
#     <a>1</a>
#     <b>2</b>
# </MyClass>

new_instance = MyClass.from_xml(xml_str)
print(new_instance.a, new_instance.b)  # Output: 1 2
```

---

## YAMLize Decorator / YAML化装饰器

Adds methods to convert an instance to/from a YAML string. / 添加方法以将实例转换为/从YAML字符串转换。

### Usage / 用法

```python
from jh_decorators.reflection import YAMLize

@YAMLize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b
```

### Methods / 方法

- `to_yaml(self)`: Convert instance to YAML string. / 将实例转换为YAML字符串。
- `from_yaml(cls, yaml_str)`: Create an instance from a YAML string. / 从YAML字符串创建实例。

### Example / 示例

```python
@YAMLize
class MyClass:
    def __init__(self, a, b):
        self.a = a
        self.b = b

instance = MyClass(1, 2)
yaml_str = instance.to_yaml()
print(yaml_str)
# Output:
# a: 1
# b: 2

new_instance = MyClass.from_yaml(yaml_str)
print(new_instance.a, new_instance.b)  # Output: 1 2
```

---

## Timing Decorator / 计时装饰器

Measures the execution time of

 a function and optionally outputs the result. / 测量函数的执行时间，并可选择输出结果。

### Usage / 用法

```python
from jh_decorators.performance import Timing

@Timing
def my_function():
    pass
```

### Arguments / 参数

- `output_obj (Optional[list])`: Optional list to store the result. / 可选列表存储结果。

### Example / 示例

```python
@Timing
def my_function():
    time.sleep(1)
    return "Done"

# This will print the execution time to the console
result = my_function()
# Output: Function my_function took 1000.0000 ms
print(result)  # Output: "Done"
```

### With Output Object / 带输出对象

```python
timing_results = []

@Timing(timing_results)
def my_function():
    time.sleep(1)
    return "Done"

result = my_function()
print(timing_results)  # Output: ["Function my_function took 1000.0000 ms"]
```

### Notes / 注意事项

1. If no output object is provided, the execution time will be printed to the console. / 如果未提供输出对象，则执行时间将打印到控制台。

---

## Log Decorator / 日志装饰器

Logs function calls, arguments, and return values. Optionally outputs the log to a list object. / 记录函数调用、参数和返回值。可选择将日志输出到列表对象。

### Usage / 用法

```python
from jh_decorators.performance import Log

@Log
def my_function(param):
    return param
```

### Arguments / 参数

- `output_obj (Optional[list])`: Optional list to store the log. / 可选列表存储日志。

### Example / 示例

```python
@Log
def my_function(param):
    return param

# This will print the log messages to the console
result = my_function("test")
# Output:
# Calling my_function with args: ('test',), kwargs: {}
# my_function returned test
print(result)  # Output: "test"
```

### With Output Object / 带输出对象

```python
log_results = []

@Log(log_results)
def my_function(param):
    return param

result = my_function("test")
print(log_results)
# Output:
# [
#     "Calling my_function with args: ('test',), kwargs: {}",
#     "my_function returned test"
# ]
```

### Notes / 注意事项

1. If no output object is provided, the log messages will be printed to the console. / 如果未提供输出对象，则日志消息将打印到控制台。

---

## ProgressBar Decorator / 进度条装饰器

Adds a progress bar to a function, with dynamic colors based on progress percentage. / 向函数添加进度条，进度条颜色根据进度百分比动态变化。

### Usage / 用法

```python
from jh_decorators.performance import ProgressBar

@ProgressBar
def my_function(total=100):
    for i in range(total):
        pass
```

### Arguments / 参数

- `func (Callable)`: The function to be decorated. / 要装饰的函数。

### Example / 示例

```python
@ProgressBar
def my_function(total=100):
    for i in range(total):
        time.sleep(0.1)

my_function()
```

---

## Annotation Decorator / 注解装饰器

Adds documentation to a function or class. / 添加文档到函数或类。

### Usage / 用法

```python
from jh_decorators.documentation import Annotation

@Annotation(args=[("param1", "Description of param1")], return_doc="Description of return value")
def my_function(param1):
    pass
```

### Arguments / 参数

- `args (List[Tuple[str, str]])`: Parameter documentation. / 参数文档。
- `return_doc (str)`: Return value description. / 返回值描述。
- `raises_doc (List[str])`: List of exceptions the function may raise. / 函数可能引发的异常列表。

### Example / 示例

```python
@Annotation(
    args=[("param1", "The first parameter"), ("param2", "The second parameter")],
    return_doc="The result of the function",
    raises_doc=["ValueError if param1 is not valid"]
)
def example_function(param1, param2):
    if not param1:
        raise ValueError("param1 is not valid")
    return param1 + param2

# The above definition will dynamically add the following docstring to the function
"""
    Args:
        param1 : The first parameter
        param2 : The second parameter

    Returns:
        The result of the function

    Raises:
        ValueError if param1 is not valid
"""
```

### Notes / 注意事项

1. The `Annotation` decorator dynamically adds documentation to the function or class, which can be checked by IDEs or static analyzers through the generated `.pyi` file using the `generate_api` function. / `Annotation` 装饰器动态添加文档到函数或类，可以通过生成的 `.pyi` 文件由 IDE 或静态分析器检查。

---

## generate_api Function / 生成API函数

Generates a `.pyi` file containing the signatures and docstrings of the annotated functions. / 生成包含注释函数签名和文档字符串的 `.pyi` 文件。

### Usage / 用法

```python
from jh_decorators.documentation import generate_api

generate_api(include_unannotated=True)
```

### Arguments / 参数

- `include_unannotated (bool)`: If True, includes functions without annotations in the generated file. / 如果为 True，则在生成的文件中包含没有注释的函数。

### Example / 示例

```python
# This will include both annotated and unannotated functions
generate_api(include_unannotated=True)

# This will include only annotated functions
generate_api(include_unannotated=False)
```

### Notes / 注意事项

1. Using `include_unannotated=True` will generate a `.pyi` file that includes all functions, whether they have annotations or not. This can be useful for ensuring all functions are visible to IDEs and static analyzers. / 使用 `include_unannotated=True` 将生成包含所有函数的 `.pyi` 文件，无论它们是否有注释。这对于确保所有函数对 IDE 和静态分析器可见非常有用。
2. Using `include_unannotated=False` will generate a `.pyi` file that includes only annotated functions, which can help focus on documented and reviewed code. / 使用 `include_unannotated=False` 将生成仅包含注释函数的 `.pyi` 文件，这有助于专注于文档化和审查的代码。

---

## Global Variable Management / 全局变量管理

### `update_global` Function / `update_global` 函数

Registers or updates a global variable or constant as internal to the module. / 注册或更新全局变量或常量，并将其标记为模块的内部变量。

### Usage / 用法

```python
from jh_decorators.interface import update_global

update_global("GLOBAL_VAR", 42)
```

### Arguments / 参数

- `name (str)`: The name of the variable or constant. / 变量或常量的名称。
- `value (Any)`: The value of the variable or constant. / 变量或常量的值。

---

### `get_global` Function / `get_global` 函数

Retrieves a global variable or constant that is marked as internal to the module. / 检索标记为模块内部的全局变量或常量。

### Usage / 用法

```python
from jh_decorators.interface import get_global

value = get_global("GLOBAL_VAR")
print(value)  # Output: 42
```

### Arguments / 参数

- `name (str)`: The name of the variable or constant. / 变量或常量的名称。

### Returns / 返回值

- `Any`: The value of the variable or constant, if it exists. / 变量或常量的值，如果存在。

### Raises / 异常

- `KeyError`: If the variable or constant is not found. / 如果找不到变量或常量，则引发 KeyError 异常。

---
If you have any questions or need further assistance, please refer to the source code or contact the maintainer. / 如果您有任何问题或需要进一步的帮助，请参考源代码或联系维护人员。

